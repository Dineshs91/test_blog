{% extends 'common/base.html' %}

{% block title %} UserProfile {% endblock %}

{% block body_block %}
	<h3>{{ name }}</h3>
	<div id="user_image">
		<img src="{{ gravatar_url }}" onerror="imgError(this);">
	</div>
	<br/>
	{% if user %}
		{{ error }}
		{% for post in posts %}
			<h4><a href="{% url 'post' post.id %}">{{ post.post_title }}</a></h4> 
			{% if is_user_author %}
			    <a href="{% url 'edit_post' post.id %}">edit</a> <a href="{% url 'delete' post.id %}" class="delete-post" >delete</a>
			{% endif %}
		{% endfor %}
	{% else %}
		<i> Author is not available </i>
	{% endif %}
	<div class="modal fade" id="myModal">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		        <h4 class="modal-title">Delete Post</h4>
		      </div>
		      <div class="modal-body">
		        <p>Are you sure you want to delete this post ?</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
		        <a type="button" class="btn btn-primary" id="delete">Yes</a>
		      </div>
		    </div><!-- /.modal-content -->
		  </div><!-- /.modal-dialog -->
		</div><!-- /.modal -->
		<script type="text/javascript">
			$(function(){
				$('.delete-post').click(function(e){
					e.preventDefault();
					$('#myModal').modal('show');
					var url = $(this).attr('href');
					$('#delete').click(function(e){
						$('#myModal').modal('hide');
						setTimeout(function(){
							window.location = url;
					    }, 500);
						return false;
					})
				});
			})
		</script>
{% endblock %}	
